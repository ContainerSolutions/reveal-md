<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>{{{title}}}</title>
    <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
    <link rel="stylesheet" href="{{{base}}}/css/reveal.css">
    <link rel="stylesheet" href="{{{themeUrl}}}" id="theme">
    <link rel="stylesheet" href="{{{highlightThemeUrl}}}">
    <!-- <link rel="stylesheet" href="{{{base}}}/css/print/{{#print}}pdf{{/print}}{{^print}}paper{{/print}}.css" type="text/css" media="print"> -->
    {{#cssPaths}}
    <link rel="stylesheet" href="{{{base}}}/{{{.}}}">
    {{/cssPaths}}

    <script>
        var link = document.createElement('link');
        link.rel = 'stylesheet';
        link.type = 'text/css';
        link.href = window.location.search.match(/print-pdf/gi) ? '{{base}}/css/print/pdf.css' : '{{base}}/css/print/paper.css';
        document.getElementsByTagName('head')[0].appendChild(link);
    </script>
    <script>
        window.onload = function(){

            document.getElementById("loading").style.display = "none";
            document.getElementsByClassName('reveal')[0].style.visibility="visible";
        }
    </script>
</head>
<body>
<div id="loading">
    <img id="loading-image" src="{{base}}/css/theme/loading.gif"/>
    <p>Loading...</p>
</div>

<div class="reveal" style="visibility: hidden">
    <div class="slides">
        <div id="left-col" class="col-left">
            <div id="left-content">
            <div id="left-inner" style="display: none;">
            <h2>{{subtitle}}</h2>
            <h3>{{authors}}</h3>
            <h4>{{job-title}}</h4>
            <h4>{{email}}</h4>
            <h4>{{twitter}}</h4>
            <h4>{{date}}</h4>
            </div>
            <div class="logo-image">
                <img src="{{base}}/css/theme/logo.svg" class="logo"/>
            </div>
            </div>
        </div>
        {{{slides}}}

    </div>
</div>

<script src="{{{base}}}/lib/js/head.min.js"></script>
<script src="{{{base}}}/js/reveal.js"></script>


<script>
    function extend() {
        var target = {};
        for (var i = 0; i < arguments.length; i++) {
            var source = arguments[i];
            for (var key in source) {
                if (source.hasOwnProperty(key)) {
                    target[key] = source[key];
                }
            }
        }
        return target;
    }

    // Optional libraries used to extend on reveal.js
    var deps = [
        {
            src: '{{{base}}}/lib/js/classList.js', condition: function () {
                return !document.body.classList;
            }
        },
        {
            src: '{{{base}}}/plugin/markdown/marked.js', condition: function () {
                return !!document.querySelector('[data-markdown]');
            }
        },
        {
            src: '{{{base}}}/plugin/markdown/markdown.js', condition: function () {
                return !!document.querySelector('[data-markdown]');
            }
        },
        {
            src: '{{{base}}}/plugin/highlight/highlight.js', async: true, callback: function () {
                hljs.initHighlightingOnLoad();
            }
        },
        {src: '{{{base}}}/plugin/zoom-js/zoom.js', async: true},
        {src: '{{{base}}}/plugin/notes/notes.js', async: true},
        {src: '{{{base}}}/plugin/math/math.js', async: true}
    ];

    // default options to init reveal.js
    var defaultOptions = {
        controls: true,
        progress: true,
        history: true,
        center: true,
        transition: 'default', // none/fade/slide/convex/concave/zoom
        dependencies: deps,
        display: 'block',
        markdown: {
            smartypants: true
        }
    };

    // options from URL query string
    var queryOptions = Reveal.getQueryHash() || {};
    var options = {{{revealOptionsStr}}};
    var showTitlePage = '{{{showLeftCol}}}' == 'true';
    var showFooterText = '{{{showFooterText}}}' == 'true';
    var hideFirstStyle = '{{{hideFirstStyle}}}' == 'true';
    options = extend(defaultOptions, options, queryOptions);
</script>

{{#scriptPaths}}
<script src="{{{base}}}/{{{.}}}"></script>
{{/scriptPaths}}

<script>

    //initializing functions

    Reveal.initialize(options);
    Reveal.addEventListener('ready', function () {
        toggleFirstSlide(Reveal.isFirstSlide());

        checkElement('#WrapInner')
            .then(function () {
                checkElement('.present')
                    .then(zoomOut);
            });

        if (window.location.search.match(/print-pdf/gi)) {
            Reveal.addEventListener('ready', function (event) {
                document.getElementById('left-col').style.display="none";
                document.getElementsByClassName('slide-background').innerHTML += footer;

            });
        }
        else {
            document.querySelectorAll('div.reveal').innerHTML += footer;
        }
    });
    Reveal.addEventListener('slidechanged', function () {
        toggleFirstSlide(Reveal.isFirstSlide());

        checkElement('#WrapInner')
            .then(function () {
                checkElement('.present')
                    .then(zoomOut);
            });
    });

    Reveal.addEventListener('ready', function () {
        var sectionContents = document.querySelectorAll('[data-markdown]');

        for (var i = 0; i < sectionContents.length; i++) {
            org_html = sectionContents[i].innerHTML;
            new_html = "<div id='WrapInner'>" + org_html + "</div>";
            sectionContents[i].innerHTML = new_html;
        }
    });

        if (window.location.search.match(/print-pdf/gi)) {
            Reveal.addEventListener('ready', function (event) {
                document.getElementsByClassName("backgrounds")[0].style.background="white";
                var printFooter = document.querySelectorAll('.slide-background');
                for (var i = 0; i < printFooter.length; i++) {
                    printFooter[i].appendChild(createFooter());
                }
                if (showFooterText) {
                    document.getElementById('footer-left').style.display = "flex";
                    document.getElementById('footer-right').style.display = "flex";
                }

                        document.getElementById('left-col').style.display="none";
                document.getElementById('footer').style.display="none";

            });
        }
        else {
            var footer = createFooter();
            document.querySelector('div.slides').appendChild(footer);
        }
    // end initializing functions

    //async function
    function rafAsync() {
        return new Promise(function (resolve) {
            requestAnimationFrame(resolve);
        });
    }

    function checkElement(selector) {
        if (document.querySelector(selector) === null) {
            return rafAsync().then(function () {
                return checkElement(selector);
            });
        } else {
            return Promise.resolve(true);
        }
    }
    //end async function
    //set width of the device
    var windowWidth = window.innerWidth
        || document.documentElement.clientWidth
        || document.body.clientWidth;
    var windowHeight = window.innerHeight
        || document.documentElement.clientHeight
        || document.body.clientHeight;
    // get the zoom scale
    function getZoom() {
        var parentElement = document.getElementsByClassName('slides')[0];
        var scale = window.getComputedStyle(document.getElementsByClassName('slides')[0]).zoom;

        if (scale != null) {
            var zoomEffect = matrixToArray(scale);

            function matrixToArray(str) {
                return str.match(/(-?[0-9\.]+)/g);
            }

        } else {
            scale = window.getComputedStyle(document.getElementsByClassName('slides')[0]).transform;
            var zoomEffect = matrixToArray(scale)[3];

            function matrixToArray(str) {
                return str.match(/(-?[0-9\.]+)/g);
            }
        }
        return {parentElement, scale, zoomEffect, zoomEffect};
    }

    // check of its first slide and toggle
    function toggleFirstSlide(isFirstSlide) {
        function rafAsync() {
            return new Promise(function (resolve) {
                requestAnimationFrame(resolve); //faster than set time out
            });
        }
        //check everytime if the element exists

        function checkElement(selector) {
            if (document.querySelector(selector) === null) {
                return rafAsync().then(function () {
                    return checkElement(selector);
                });
            } else {
                return Promise.resolve(true);
            }
        }
        //check if footer exists
        checkElement('#footer')
            .then(function () {

                if(showFooterText) {
                    document.getElementById('footer-left').style.display="flex";
                    document.getElementById('footer-right').style.display="flex";
                }


            });
        //check if it has first-slide class
        checkElement('.first-slide')
            .then(function () {
                if (showTitlePage) {
                    document.getElementById('left-inner').style.display = "block";
                }
            });
            //call the zoom function
            var {parentElement, scale, zoomEffect, zoomEffect} = getZoom();



        <!--    functions on the first slide vs on the other slides   -->
        //check if this is the first slide
            if (isFirstSlide) {
                document.getElementById('left-col').style.display = "block";

                document.getElementsByClassName('slides')[0].classList.add('firstOfSlides');
                checkElement('.first-slide')
                    .then(function () {
                        if (window.location.search.match(/print-pdf/gi)) {
                            document.getElementById('footer').style.display='none';
                            document.getElementById('left-col').style.display = "none";
                            if(showFooterText) {
                                document.getElementById('footer-left').style.display="flex";
                                document.getElementById('footer-right').style.display="flex";}
                        }else{
                            document.getElementById('footer').style.display='none';
                        }

                        var middleSection = Math.ceil(document.getElementsByClassName('slides')[0].clientWidth * zoomEffect);

                        //check window width and height
                        var windowWidth = window.innerWidth
                            || document.documentElement.clientWidth
                            || document.body.clientWidth;
                        var windowHeight = window.innerHeight
                            || document.documentElement.clientHeight
                            || document.body.clientHeight;
                        //set the width of the left-col accordingly to the space remaining from window - section
                        document.getElementById('left-col').style.width = Math.ceil((windowWidth - middleSection) / zoomEffect) + 'px';

                        //attribute that to a variable
                        var colLeftWidth = document.getElementById('left-col').clientWidth;

                        //check if its firefox browser and calculate the margin-left of the section
                        var isFF = !!navigator.userAgent.match(/firefox/i);
                        if(isFF){
                            parentElement.style.marginLeft =(windowWidth - (parentElement.clientWidth *zoomEffect))/2 + "px";
                            document.getElementById('left-col').style.marginTop ="-" +(windowHeight - (parentElement.clientHeight *zoomEffect))/2 + "px";
                        } else {
                            parentElement.style.marginLeft = colLeftWidth + 'px';
                        }

                        // get the margin-left of the left column
                        document.getElementById('left-col').style.marginLeft = '-' + Math.ceil((windowWidth - middleSection) / zoomEffect) + 'px';
                    });
                //set the footer width to the window width
                checkElement('#footer')
                    .then(function () {
                        document.getElementById('footer').style.width = (windowWidth / zoomEffect) + 'px';
                        //calculate how much the margin-left is
                        var offsetRight = (windowWidth - (parentElement.clientWidth * zoomEffect))/2;
                        //pull the footer to the point left 0 of the window
                        document.getElementById('footer').style.marginLeft= "-" + (offsetRight/zoomEffect) + "px";
                    });


            } else {
                //if its not first slide revert styles to centered normal
                document.getElementById('footer').style.display='block';
                document.getElementById('left-col').style.display = "none";
                document.getElementById('left-col').style.width = "0";
                document.getElementById('left-col').style.marginLeft = "0";
                parentElement.style.marginLeft = "auto";

                var parentElement = document.getElementsByClassName('slides')[0];
                checkElement('.first-slide')
                    .then(function () {
                        document.getElementsByClassName('slides')[0].classList.remove('firstOfSlides');
                    });

                //set the footer width to the window width
                document.getElementById('footer').style.width = (windowWidth / zoomEffect) + 'px';
                //calculate how much the margin-left is
                var offsetRight = (windowWidth - (parentElement.clientWidth * zoomEffect))/2;
                //pull the footer to the point left 0 of the window
                document.getElementById('footer').style.marginLeft= "-" + (offsetRight/zoomEffect) + "px";
                if (window.location.search.match(/print-pdf/gi)) {
                    document.getElementById('footer').style.display='flex';
                    if(showFooterText) {
                        document.getElementById('footer-left').style.display="flex";
                        document.getElementById('footer-right').style.display="flex";}
                }

            }
            //toggle classes on options to hide or show first slide styling
            if (isFirstSlide) {
                document.getElementsByClassName('reveal')[0].classList.add('first-slide');
                document.getElementsByClassName('backgrounds')[0].classList.add('first-slide');

                if (hideFirstStyle) {
                    document.getElementsByClassName('reveal')[0].classList.remove('first-slide');
                    document.getElementsByClassName('backgrounds')[0].classList.remove('first-slide');
                    document.getElementById('left-content').style.display = "none";

                }
                if (window.location.search.match(/print-pdf/gi)) {
                    document.getElementById('left-col').style.display = "none";
                    document.getElementById('left-content').style.display = "none";
                }

            } else {
                document.getElementsByClassName('reveal')[0].classList.remove('first-slide');
                document.getElementsByClassName('backgrounds')[0].classList.remove('first-slide');


            }

    }

    <!--     Left column  -->

    <!--    Footer    -->
    //create the footer and implement it in the section to be scaled as well depending on the screen-size
    function createFooter() {
        var footer = document.createElement('div');
        footer.className = 'hidden';

        //always display for print screen if the option is checked

        if (window.location.search.match(/print-pdf/gi)) {
            if (showFooterText) {
                footer.innerHTML =
                    '<div id="footer" class="printFooter">\n' +
                    '<div id="footer-left" style="display: flex;"><p>container-solutions.com</p><p>{{email}}</p></div>\n' +
                    '<div id="footer-right" style="display: flex;"><p class="title">{{title}}</p> <p>{{{twitter}}}</p></div>\n' +
                    '</div>';
            } else {
                footer.innerHTML =
                    '<div id="footer" class="printFooter">\n' +
                    '<div id="footer-left" style="display: none;"><p>container-solutions.com</p><p>{{email}}</p></div>\n' +
                    '<div id="footer-right" style="display: none;"><p class="title">{{title}}</p> <p>{{{twitter}}}</p></div>\n' +
                    '</div>';
            }
        } else {
            footer.innerHTML =
                '<div id="footer">\n' +
                '<div id="footer-left" style="display: none;"><p>container-solutions.com</p><p>{{email}}</p></div>\n' +
                '<div id="footer-right" style="display: none;"><p class="title">{{title}}</p> <p>{{{twitter}}}</p></div>\n' +
                '</div>';
        }
        return footer;
    }
    <!--   / Footer    -->

    <!--    Scaling down    -->

    //make content fit the window height(scale down) so it doesn't overflow on the bottom
    function zoomOut() {
        var {parentElement, scale, zoomEffect, zoomEffect} = getZoom();

        var childSizing = document.querySelectorAll('.present[data-markdown] #WrapInner')[0];
        if (childSizing === null) {
            return;
        }
        //get the height of the inner content
        var footer = document.getElementById('footer');
        var footerHeight = footer.clientHeight;
        var refHeight = childSizing.clientHeight + (footerHeight / zoomEffect);
        var refWidth = childSizing.clientWidth;


        //call the zoom function



        //and of the parent
        var parentSizing = document.getElementsByClassName('slides')[0];
        var parentHeight = parentSizing.clientHeight;
        // var parentHeight = parentSizing.clientHeight - footerHeight;

        var parentWidth = parentSizing.clientWidth;

        //calculate how much it should be scaled down
        var scaleDown = Math.min(
            parentWidth / refWidth,
            parentHeight / refHeight
        );

        //calculate how much it should be dragged upwards after scaling down
        var translateY = Math.min((parentHeight - refHeight)/2);
        //check if then content height is bigger than the window height and scale it

        if (parentHeight < refHeight) {
            if (window.location.search.match(/print-pdf/gi)) {
                childSizing.style.transform = "unset";
            }
            else {
                //besides scaling down drag it up as well so its at the top of the window
                childSizing.style.transform = "translateY(" + translateY + "px) scale(" + scaleDown + ")";
            }
        }

    }


</script>


</body>
</html>




